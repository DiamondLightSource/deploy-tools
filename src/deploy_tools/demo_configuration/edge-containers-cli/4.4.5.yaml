# yaml-language-server: $schema=/workspaces/deploy-tools/src/deploy_tools/models/schemas/release.json

module:
  name: edge-containers-cli
  version: "4.4.5"
  description: ec command line tool for kubernetes IOCs
  allow_updates: true

  dependencies:
    - name: argocd
      version: v2.14.10
    - name: uv
      version: "0.8.13"

  env_vars:
    - name: EC_CLI_BACKEND
      value: ARGOCD
    - name: EC_LOG_URL
      value: "https://graylog.diamond.ac.uk/search/685bf28614798490bd989745?q=pod_name%3A{service_name}%2A&rangetype=relative&from=28800"
    - name: EC_LOGIN
      value: argocd login argocd.diamond.ac.uk --grpc-web --sso

  applications:
    - app_type: shell
      name: ec
      script:
        - uvx -q --upgrade --from edge-containers-cli==5.0.0-alpha.1 ec "${@}"

    - app_type: shell
      name: ec-login
      script:
        - argocd login argocd.diamond.ac.uk --grpc-web --sso
        - kubectl version
